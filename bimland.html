<!-- ============================
  BIM Labs — Contractors Landing + Instant Quote (drop-in)
  Brand: #101014 / #4EC6FF / #FFFFFF
  AOS fade-only
============================= -->

<section id="contractors" class="ctr-wrap" aria-labelledby="ctrTitle">
  <div class="ctr-rail" aria-hidden="true"></div>

  <div class="ctr-shell">
    <header class="ctr-head" data-aos="fade-up">
      <p class="ctr-eyebrow">For Contractors</p>
      <h2 id="ctrTitle" class="ctr-title">Stop losing jobs to slow quotes.</h2>
      <p class="ctr-sub">Give prospects a professional ballpark in 60 seconds, capture the lead, and auto-book a site assessment. Our instant quote tool replaces days of back-and-forth and wins the speed game.</p>
      <ul class="ctr-proof">
        <li>Ballpark quotes with ± confidence</li>
        <li>Trade-specific pricing logic</li>
        <li>PDF/email summary to client</li>
      </ul>
    </header>

    <!-- ===== Instant Quote Tool ===== -->
    <section id="iqt" class="iqt" aria-label="Instant Quote Tool" data-aos="fade-up">
      <form id="iqtForm" class="iqt-form" novalidate>
        <div class="iqt-grid">
          <div class="iqt-left">
            <div class="iqt-row">
              <label class="iqt-label" for="trade">Trade</label>
              <select id="trade" class="iqt-input" required>
                <option value="roofing">Roofing</option>
                <option value="landscaping">Landscaping</option>
                <option value="remodel">Remodel</option>
                <option value="hvac">HVAC</option>
              </select>
            </div>

            <div class="iqt-row">
              <label class="iqt-label" for="size">Project size (sq ft)</label>
              <input id="size" class="iqt-input" type="number" min="50" step="10" value="1200" required>
            </div>

            <div class="iqt-row">
              <label class="iqt-label" for="complexity">Complexity</label>
              <select id="complexity" class="iqt-input" required>
                <option value="low">Low</option>
                <option value="standard" selected>Standard</option>
                <option value="high">High</option>
              </select>
            </div>

            <div class="iqt-row iqt-row--two">
              <label class="iqt-check"><input id="premium" type="checkbox"> <span>Premium materials</span></label>
              <label class="iqt-check"><input id="rush" type="checkbox"> <span>Rush turnaround</span></label>
            </div>

            <div class="iqt-row">
              <label class="iqt-label" for="distance">Distance from your shop (miles)</label>
              <input id="distance" class="iqt-input" type="number" min="0" step="1" value="12">
            </div>

            <div class="iqt-actions">
              <button type="button" id="estimateBtn" class="iqt-btn iqt-primary">Get Instant Estimate</button>
              <button type="button" id="bookBtn" class="iqt-btn iqt-ghost">Book a Site Assessment</button>
            </div>
          </div>

          <aside class="iqt-right" aria-live="polite">
            <div class="iqt-card">
              <h3 class="iqt-card-title">Estimated Range</h3>
              <div class="iqt-nums">
                <div>
                  <div class="iqt-num" id="lowNum">$—</div>
                  <div class="iqt-hint">Low</div>
                </div>
                <div>
                  <div class="iqt-num" id="highNum">$—</div>
                  <div class="iqt-hint">High</div>
                </div>
              </div>

              <div class="iqt-conf">
                <span class="iqt-conf-label">Confidence</span>
                <div class="iqt-conf-bar"><span id="confBar" style="width:0%"></span></div>
                <span class="iqt-conf-note" id="confNote">—</span>
              </div>

              <div class="iqt-break">
                <div class="iqt-line"><span>Materials</span><strong id="materialsNum">$—</strong></div>
                <div class="iqt-line"><span>Labor</span><strong id="laborNum">$—</strong></div>
                <div class="iqt-line"><span>Travel & Overhead</span><strong id="overheadNum">$—</strong></div>
              </div>

              <p class="iqt-disclaimer">This is a preliminary ballpark. We’ll confirm on a quick call or site visit before work begins.</p>
            </div>

            <div class="iqt-card">
              <h3 class="iqt-card-title">Email Me This Estimate</h3>
              <div class="iqt-row">
                <label class="iqt-label" for="name">Name</label>
                <input id="name" class="iqt-input" type="text" autocomplete="name" required>
              </div>
              <div class="iqt-row">
                <label class="iqt-label" for="email">Email</label>
                <input id="email" class="iqt-input" type="email" autocomplete="email" required>
              </div>
              <div class="iqt-row">
                <label class="iqt-label" for="phone">Phone (optional)</label>
                <input id="phone" class="iqt-input" type="tel" autocomplete="tel">
              </div>

              <div class="iqt-actions">
                <button type="submit" class="iqt-btn iqt-primary" id="sendBtn">
                  <span class="iqt-btn-label">Send & Request Call</span>
                  <span class="iqt-spinner" aria-hidden="true"></span>
                </button>
                <p class="iqt-trust">We reply same-day. No spam.</p>
              </div>

              <p class="iqt-error" id="iqtError" role="alert" hidden></p>
              <div class="iqt-success" id="iqtSuccess" hidden>
                <div class="iqt-check" aria-hidden="true"></div>
                <p>Sent. We’ll email your estimate and next steps today.</p>
              </div>
            </div>
          </aside>
        </div>
      </form>
    </section>
  </div>
</section>

<style>
/* ===== Brand ===== */
.ctr-wrap{ --black:#101014; --blue:#4EC6FF; --white:#fff; --ink:#E8EEF6; --muted:#B8C6D8; --line:#1E232E; --glass:rgba(16,22,30,.78);
  background:var(--black); color:var(--ink); font-family:'Montserrat',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; }
.ctr-rail{ height:6px; background:linear-gradient(90deg,var(--blue),rgba(78,198,255,.35),var(--blue)); box-shadow:0 10px 28px #4ec6ff2b; }
.ctr-shell{ width:min(1100px,92vw); margin:0 auto; padding: clamp(28px,4vw,46px) 0; }

.ctr-head{text-align:center}
.ctr-eyebrow{ color:var(--blue); font-weight:900; text-transform:uppercase; letter-spacing:.18em; font-size:.8rem; margin:0 0 .6rem }
.ctr-title{ margin:.2rem 0 .5rem; font-weight:900; line-height:1.06; font-size:clamp(30px,5vw,46px); color:#fff }
.ctr-sub{ max-width:70ch; margin:0 auto; color:var(--muted) }
.ctr-proof{ display:flex; gap:.6rem; flex-wrap:wrap; justify-content:center; margin:1rem 0 0; padding:0; list-style:none }
.ctr-proof li{ padding:.45rem .8rem; border-radius:999px; background:rgba(255,255,255,.05); border:1px solid #243146; color:#bcd2ea; font-weight:800 }

/* ===== Tool layout ===== */
.iqt{ margin-top: clamp(18px,4vw,32px) }
.iqt-grid{ display:grid; gap:22px; grid-template-columns: 1fr 1fr; align-items:start }
@media (max-width:900px){ .iqt-grid{ grid-template-columns:1fr } }

.iqt-left{ background:var(--glass); border:1px solid var(--line); border-radius:16px; padding:1.1rem; box-shadow:0 10px 36px rgba(0,0,0,.35), 0 6px 24px rgba(78,198,255,.12) }
.iqt-right{ display:grid; gap:16px }
.iqt-card{ background:var(--glass); border:1px solid var(--line); border-radius:16px; padding:1.1rem; box-shadow:0 10px 36px rgba(0,0,0,.35), 0 6px 24px rgba(78,198,255,.12) }
.iqt-card-title{ margin:0 0 .6rem; font-size:1.05rem; font-weight:900; color:#eaf3ff }

.iqt-row{ margin:.55rem 0 }
.iqt-row--two{ display:flex; gap:12px; align-items:center }
.iqt-label{ display:block; font-weight:900; color:var(--blue); margin:.2rem 0 .25rem }
.iqt-input{ width:100%; background:#0f141c; color:#eaf3ff; border:1px solid #223146; border-radius:10px; padding:.8rem 1rem; font-size:1rem; outline:none; transition:border .15s, box-shadow .15s }
.iqt-input:focus{ border-color:#2a90c6; box-shadow:0 0 0 6px rgba(78,198,255,.18) }
.iqt-check{ display:flex; align-items:center; gap:.5rem; color:#cfe1f4; font-weight:800 }
.iqt-actions{ display:flex; gap:.6rem; flex-wrap:wrap; margin-top:1rem }

.iqt-btn{ display:inline-flex; align-items:center; gap:.6rem; border:none; border-radius:999px; cursor:pointer; font-weight:900; padding:.9rem 1.4rem; text-decoration:none }
.iqt-primary{ background:var(--blue); color:#091018; box-shadow:0 12px 30px rgba(78,198,255,.28) }
.iqt-primary:hover{ filter:brightness(.96) }
.iqt-ghost{ background:#0E1116; color:#fff }

.iqt-nums{ display:flex; gap:16px; justify-content:space-between; align-items:flex-end; margin:.2rem 0 .4rem }
.iqt-num{ font-size:clamp(20px,3.2vw,32px); font-weight:900; color:#fff }
.iqt-hint{ color:#9db2c8; font-weight:700; font-size:.92rem }

.iqt-conf{ margin:.2rem 0 .6rem }
.iqt-conf-label{ font-weight:900; color:#9fd6ff; margin-right:.4rem }
.iqt-conf-bar{ height:8px; background:#162033; border:1px solid #223146; border-radius:999px; overflow:hidden; display:inline-block; width:160px; vertical-align:middle }
.iqt-conf-bar span{ display:block; height:100%; background:linear-gradient(90deg,#4EC6FF,#8EE4FF) }

.iqt-break{ border-top:1px solid #243146; margin-top:.6rem; padding-top:.6rem; display:grid; gap:.25rem }
.iqt-line{ display:flex; justify-content:space-between; color:#cfe1f4 }

.iqt-disclaimer{ color:#9ab0c9; font-size:.92rem; margin:.6rem 0 0 }

.iqt-trust{ color:#9ab0c9; font-size:.92rem; margin: .2rem 0 0 }
.iqt-spinner{ width:18px; height:18px; border-radius:50%; border:2px solid rgba(255,255,255,.6); border-top-color:#0E1116; display:none }
.iqt-btn.is-loading .iqt-spinner{ display:inline-block; animation:spin .8s linear infinite }
@keyframes spin{ to{ transform:rotate(360deg) } }

.iqt-error{ color:#ff9b9b; font-weight:800; margin:.5rem 0 0 }
.iqt-success{ background:#0f141c; border:1px solid #243146; border-radius:12px; padding:.8rem; text-align:center; margin-top:.6rem }
.iqt-check{ width:22px; height:22px; border-radius:50%; background:#22d3ee; margin:.2rem auto .4rem; position:relative; box-shadow:0 0 0 6px #22d3ee22 }
.iqt-check::after{ content:""; position:absolute; left:6px; top:5px; width:8px; height:4px; border:3px solid #0b1320; border-top:none; border-right:none; transform:rotate(-45deg) }
</style>

<script>
/**
 * Simple, credible ballpark engine with ranges & confidence.
 * Tune CONFIG to your trades. All numbers are examples.
 */
(function(){
  const CONFIG = {
    roofing: {
      baseRate: 7.5,    // $/sqft baseline
      minBase: 8500,    // minimum viable job
      comp: { low: 0.9, standard: 1.0, high: 1.25 },
      premiumMaterials: 1.18,
      laborFactor: 0.42,   // share of total considered labor
      overheadPerMile: 2.2, // $/mile
      rush: 1.10
    },
    landscaping: {
      baseRate: 6.2, minBase: 6000,
      comp: { low: 0.92, standard: 1.0, high: 1.3 },
      premiumMaterials: 1.22,
      laborFactor: 0.46,
      overheadPerMile: 1.6,
      rush: 1.08
    },
    remodel: {
      baseRate: 14.0, minBase: 12000,
      comp: { low: 0.95, standard: 1.0, high: 1.35 },
      premiumMaterials: 1.20,
      laborFactor: 0.50,
      overheadPerMile: 2.8,
      rush: 1.12
    },
    hvac: {
      baseRate: 9.0, minBase: 6500,
      comp: { low: 0.9, standard: 1.0, high: 1.3 },
      premiumMaterials: 1.15,
      laborFactor: 0.44,
      overheadPerMile: 2.0,
      rush: 1.12
    }
  };

  const els = {
    trade: document.getElementById('trade'),
    size: document.getElementById('size'),
    complexity: document.getElementById('complexity'),
    premium: document.getElementById('premium'),
    rush: document.getElementById('rush'),
    distance: document.getElementById('distance'),
    lowNum: document.getElementById('lowNum'),
    highNum: document.getElementById('highNum'),
    materialsNum: document.getElementById('materialsNum'),
    laborNum: document.getElementById('laborNum'),
    overheadNum: document.getElementById('overheadNum'),
    confBar: document.getElementById('confBar'),
    confNote: document.getElementById('confNote'),
    estimateBtn: document.getElementById('estimateBtn'),
    bookBtn: document.getElementById('bookBtn'),
    form: document.getElementById('iqtForm'),
    name: document.getElementById('name'),
    email: document.getElementById('email'),
    phone: document.getElementById('phone'),
    error: document.getElementById('iqtError'),
    success: document.getElementById('iqtSuccess'),
    sendBtn: document.getElementById('sendBtn'),
  };

  function money(n){ return n.toLocaleString(undefined,{ style:'currency', currency:'USD', maximumFractionDigits:0 }); }
  function clamp(v,min,max){ return Math.max(min, Math.min(max, v)); }

  function compute(){
    const T = CONFIG[els.trade.value];
    const sqft = Math.max(0, Number(els.size.value||0));
    const comp = T.comp[els.complexity.value] || 1.0;
    const isPrem = els.premium.checked;
    const isRush = els.rush.checked;
    const miles = Math.max(0, Number(els.distance.value||0));

    // Baseline
    let base = Math.max(T.minBase, sqft * T.baseRate);
    base *= comp;
    if(isPrem) base *= T.premiumMaterials;
    if(isRush) base *= T.rush;
    const overhead = miles * T.overheadPerMile * 2; // there & back

    const subtotal = base + overhead;

    // Confidence: larger size + standard complexity => higher confidence
    let conf = 0.55;
    if (sqft > 1000) conf += 0.15;
    if (sqft > 2000) conf += 0.1;
    if (els.complexity.value === 'low') conf += 0.05;
    if (els.complexity.value === 'high') conf -= 0.07;
    if (isPrem) conf -= 0.03;
    conf = clamp(conf, 0.45, 0.9);

    // Range width based on confidence (tighter if higher confidence)
    const spread = (1 - conf) * 0.35 + 0.10; // 10% to 45%
    const low = subtotal * (1 - spread/2);
    const high = subtotal * (1 + spread/2);

    // Breakout (very simple shares)
    const labor = subtotal * T.laborFactor;
    const materials = subtotal * (1 - T.laborFactor) - overhead;

    return { low, high, materials, labor, overhead, conf, sqft };
  }

  function render(){
    const r = compute();
    els.lowNum.textContent = money(r.low);
    els.highNum.textContent = money(r.high);
    els.materialsNum.textContent = money(Math.max(0, r.materials));
    els.laborNum.textContent = money(Math.max(0, r.labor));
    els.overheadNum.textContent = money(Math.max(0, r.overhead));
    const pct = Math.round(r.conf*100);
    els.confBar.style.width = pct + '%';
    els.confNote.textContent = `±${Math.round(((r.high - r.low)/((r.high+r.low)/2))*100/2)}% • ${pct}% confidence`;
  }

  // Initial render and on change
  ['trade','size','complexity','premium','rush','distance'].forEach(id=>{
    els[id].addEventListener('input', render);
  });
  render();

  // Quick “book assessment” scroll
  els.bookBtn.addEventListener('click', ()=>{
    document.getElementById('contact')?.scrollIntoView({behavior:'smooth'});
  });

  // Submit to Formspree with full payload
  els.form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    els.error.hidden = true; els.success.hidden = true;

    // simple validation
    if(!els.name.value.trim() || !els.email.value.trim()){
      els.error.textContent = 'Please enter your name and email.';
      els.error.hidden = false;
      return;
    }

    const r = compute();
    const payload = {
      source: 'BIM Instant Quote (Contractors)',
      trade: els.trade.value,
      size_sqft: Number(els.size.value||0),
      complexity: els.complexity.value,
      premium_materials: els.premium.checked,
      rush: els.rush.checked,
      distance_miles: Number(els.distance.value||0),
      estimate_low: Math.round(r.low),
      estimate_high: Math.round(r.high),
      materials: Math.round(Math.max(0, r.materials)),
      labor: Math.round(Math.max(0, r.labor)),
      overhead: Math.round(Math.max(0, r.overhead)),
      confidence: r.conf,
      name: els.name.value.trim(),
      email: els.email.value.trim(),
      phone: els.phone.value.trim()
    };

    els.sendBtn.classList.add('is-loading');
    els.sendBtn.setAttribute('disabled','disabled');

    try{
      await fetch('https://formspree.io/f/xkgbgbjd', {
        method:'POST',
        headers:{ 'Accept':'application/json','Content-Type':'application/json' },
        body: JSON.stringify(payload)
      });
      els.success.hidden = false;
      els.form.querySelectorAll('input,select,button').forEach(el=>el.disabled=true);
    }catch(err){
      els.error.textContent = 'Could not send right now. Please try again in a moment.';
      els.error.hidden = false;
    }finally{
      els.sendBtn.classList.remove('is-loading');
      els.sendBtn.removeAttribute('disabled');
    }
  });

  // Also compute on click
  document.getElementById('estimateBtn').addEventListener('click', render);
})();
</script>
