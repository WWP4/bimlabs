<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>BIM Labs — Contractors Founder Program</title>
<meta name="description" content="Go live in 14–21 days with a contractor site, Instant Quote flow, and ready-to-run campaigns. Founder Program: 3 contractors at $3,000. You own everything—no retainer." />
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800;900&display=swap" rel="stylesheet" />
<style>
/* ===== Base ===== */
*{box-sizing:border-box}
html,body{height:100%}
html{scroll-behavior:smooth}
body{margin:0;background:#101014;color:#E8EEF6;font-family:'Montserrat',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;letter-spacing:.01em;overflow-y:scroll;scroll-snap-type:y mandatory}
:root{--black:#101014;--blue:#4EC6FF;--white:#fff;--ink:#E8EEF6;--muted:#B8C6D8;--line:#1E232E;--glass:rgba(16,22,30,.78)}
.shell{width:min(1200px,92vw);margin:0 auto}
.hint{color:#9db2c8;font-size:.95rem}
.pill{display:inline-block;background:#101a27;color:#9fd6ff;border:1px solid #243146;font-weight:900;padding:.26rem .7rem;border-radius:999px}
.card{background:var(--glass);border:1px solid var(--line);border-radius:16px;box-shadow:0 10px 36px rgba(0,0,0,.35),0 6px 24px rgba(78,198,255,.12)}
.card-head{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:14px 16px;border-bottom:1px solid #243146;background:linear-gradient(180deg,rgba(255,255,255,.03),transparent)}
.card-title{margin:0;font-size:1.12rem;font-weight:900;color:#eaf3ff}
.card-body{padding:16px}
.btn{display:inline-flex;align-items:center;justify-content:center;gap:.6rem;padding:.95rem 1.5rem;border-radius:999px;font-weight:900;text-decoration:none;cursor:pointer;border:none;min-width:180px}
.btn--primary{background:var(--blue);color:#0b1016;box-shadow:0 12px 30px rgba(78,198,255,.28)}
.btn--primary:hover{filter:brightness(.96)}
.btn--ghost{background:#0E1116;color:#fff;border:1px solid #1E232E}
.label{display:block;font-weight:900;color:var(--blue);margin:.2rem 0 .25rem}
.input{width:100%;background:#0f141c;color:#eaf3ff;border:1px solid #223146;border-radius:10px;padding:.82rem 1rem;font-size:1rem;outline:none;transition:border .15s,box-shadow .15s}
.input:focus{border-color:#2a90c6;box-shadow:0 0 0 6px rgba(78,198,255,.18)}
.sec{border:1px solid #243146;border-radius:12px;padding:12px;background:#0f141c;margin:10px 0}
.sec-title{margin:0 0 8px;font-weight:900;color:#9fd6ff;font-size:.98rem}

/* ===== Panels ===== */
.panel{min-height:100svh;display:grid;place-items:center;padding:clamp(28px,6vw,72px);position:relative;scroll-snap-align:start;overflow:hidden}
.panel .shell{width:min(1200px,92vw);margin:0 auto}
.panel--img{isolation:isolate}
.panel--img::before{content:"";position:absolute;inset:0;background:center/cover no-repeat var(--panel-img, none);filter:saturate(1.04) contrast(1.02) brightness(.78);transform:scale(1.03);z-index:-2}
.panel--img::after{content:"";position:absolute;inset:0;background:linear-gradient(180deg,rgba(8,12,18,.78) 0%,rgba(8,12,18,.55) 48%,rgba(8,12,18,.30) 100%),radial-gradient(700px 200px at 50% 0%,rgba(78,198,255,.15),transparent 70%);z-index:-1}

/* ===== Hero ===== */
.hero{min-height:92vh;display:grid;place-items:center;position:relative;overflow:hidden;background:radial-gradient(900px 600px at 82% -10%,rgba(78,198,255,.08),transparent 60%),radial-gradient(800px 500px at -10% 0%,rgba(78,198,255,.06),transparent 60%),var(--black)}
.hero__bg{position:absolute;inset:0;background:url('https://images.unsplash.com/photo-1600585154526-990dced4db0d?q=80&w=1920&auto=format&fit=crop') center/cover no-repeat;filter:saturate(1.05) contrast(1.02) brightness(.72);transform:scale(1.08);opacity:0}
.hero__overlay{position:absolute;inset:0;background:linear-gradient(180deg,rgba(8,12,18,.78) 0%,rgba(8,12,18,.55) 48%,rgba(8,12,18,.35) 70%,rgba(8,12,18,.2) 100%),radial-gradient(600px 160px at 50% 0%,rgba(78,198,255,.18),transparent 70%);opacity:0}
.hero__rail{height:6px;width:100%;position:absolute;top:0;left:0;background:linear-gradient(90deg,var(--blue),rgba(78,198,255,.35),var(--blue));box-shadow:0 10px 28px #4ec6ff2b;transform:translateX(-30%);opacity:0}
.hero__in{position:relative;z-index:2;width:min(1100px,92vw);margin:0 auto;padding:clamp(40px,6vw,90px) 0}
.eyebrow{color:var(--blue);text-transform:uppercase;letter-spacing:.18em;font-weight:900;font-size:.8rem;margin:0 0 .6rem}
.h1{margin:.1rem 0 .6rem;font-weight:900;line-height:1.04;font-size:clamp(34px,6vw,64px);color:#fff}
.sub{max-width:70ch;color:var(--muted);margin:0 0 1.1rem;font-size:clamp(1rem,2vw,1.2rem)}
.chips{display:flex;gap:.6rem;flex-wrap:wrap;margin:.7rem 0 1.2rem;padding:0;list-style:none}
.chips li{padding:.45rem .8rem;border-radius:999px;background:rgba(255,255,255,.05);border:1px solid #243146;color:#bcd2ea;font-weight:800;font-size:.95rem}
.cta{display:flex;gap:.8rem 1rem;flex-wrap:wrap;margin-top:.6rem}
@keyframes floatIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:none}}
.hero__bg,.hero__overlay,.hero__rail{animation:floatIn .9s ease forwards}
.hero__bg{animation-delay:.15s}.hero__overlay{animation-delay:.3s}.hero__rail{animation-delay:.45s}

/* ===== Sections ===== */
.section{padding:clamp(32px,6vw,72px) 0;background:radial-gradient(900px 600px at 12% -10%,rgba(78,198,255,.06),transparent 60%),#101014}

/* ===== Quiz ===== */
.quizpanel{display:grid;place-items:center;text-align:center}
.qp-wrap{width:min(1040px,92vw);margin:0 auto}
.qp-intro{max-width:70ch;margin:0 auto 16px;color:#B8C6D8}
.qp-card{margin:16px auto 0;border:1px solid #1F2A3A;border-radius:20px;background:linear-gradient(180deg,rgba(255,255,255,.03),transparent 30%),#0f141c;box-shadow:0 30px 80px rgba(0,0,0,.45),0 20px 60px rgba(78,198,255,.12);overflow:hidden;padding:16px;transform:translateY(12px);opacity:0;animation:qpIn .7s ease .2s forwards}
@keyframes qpIn{to{transform:none;opacity:1}}
.qp-head{display:flex;align-items:center;justify-content:space-between;gap:12px;padding-bottom:10px;border-bottom:1px solid #223146}
.qp-title{margin:0;font-weight:900;color:#EAF3FF;font-size:1.05rem}
.qp-pill{display:inline-block;padding:.35rem .8rem;border-radius:999px;border:1px solid #26405a;color:#9fd6ff;font-weight:900}
.qp-rail{height:8px;background:#162033;border:1px solid #223146;border-radius:999px;overflow:hidden;margin-top:12px}
.qp-rail i{display:block;height:100%;background:linear-gradient(90deg,#4EC6FF,#8EE4FF);width:0%}
.qp-grid{display:grid;gap:12px;margin-top:12px}
.qp-grid.two{grid-template-columns:1fr 1fr}
@media (max-width:780px){.qp-grid.two{grid-template-columns:1fr}}
.qp .label{display:block;font-weight:900;color:#9fd6ff;margin:.2rem 0 .25rem}
.qp .input,.qp textarea,.qp select{width:100%;background:#0d131b;color:#eaf3ff;border:1px solid #223146;border-radius:10px;padding:.82rem 1rem;font-size:1rem;outline:none;transition:border .15s,box-shadow .15s}
.qp .input:focus,.qp textarea:focus,.qp select:focus{border-color:#2a90c6;box-shadow:0 0 0 6px rgba(78,198,255,.18)}
.qp textarea{min-height:120px;resize:vertical}
.qp-actions{display:flex;justify-content:space-between;gap:10px;margin-top:12px}
.qp-actions .btn{min-width:140px}
.qp-err{color:#ff9b9b;font-weight:800;display:none;text-align:left}
.qp-ok{display:none;text-align:center;margin-top:10px;padding:.8rem;border:1px solid #243146;border-radius:12px;background:#0f141c}

/* ===== Sticky CTA & Footer ===== */
.stickybar{position:fixed;left:0;right:0;bottom:0;z-index:999;background:#0E1116;border-top:1px solid #1e232e;box-shadow:0 -6px 24px rgba(0,0,0,.25)}
.stickybar__in{display:flex;gap:12px;align-items:center;justify-content:space-between;padding:10px 0}
.footer{border-top:1px solid #1e232e;padding:20px 0;text-align:center;color:#b6c2d1}
/* === Immersive How-It-Works Flow === */
.flow{position:relative}
.flow-rail{height:10px;background:#0f141c;border:1px solid #223146;border-radius:999px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,.25) inset}
.flow-bar{height:100%;width:0%;background:linear-gradient(90deg,#4EC6FF,#8EE4FF);transition:width .7s ease}
.flow-steps{display:grid;gap:16px;margin-top:18px;grid-template-columns:repeat(4,1fr)}
@media (max-width:900px){.flow-steps{grid-template-columns:1fr 1fr}}
.flow-step{border:1px solid #243146;border-radius:14px;padding:14px;background:#0f141c;opacity:.55;transform:translateY(6px);transition:opacity .4s ease, transform .4s ease, box-shadow .4s ease}
.flow-step.is-on{opacity:1;transform:none;box-shadow:0 16px 40px rgba(78,198,255,.12)}
.flow-ico{display:inline-flex;width:36px;height:36px;border-radius:10px;align-items:center;justify-content:center;background:#101a27;border:1px solid #223146;margin-bottom:8px}
.flow-ttl{margin:.1rem 0 .2rem;font-weight:900;color:#eaf3ff}
.flow-hint{margin:0;color:#9db2c8}
.flow-done{margin-top:16px;border:1px dashed #2b3a50;border-radius:14px;padding:14px;text-align:center;background:linear-gradient(180deg,rgba(255,255,255,.02),transparent 40%),#0f141c}
.flow-done b{color:#9fd6ff}

</style>
</head>
<body>

<!-- HERO -->
<header class="hero" id="top" aria-label="Hero">
  <div class="hero__rail" aria-hidden="true"></div>
  <div class="hero__bg" aria-hidden="true"></div>
  <div class="hero__overlay" aria-hidden="true"></div>
  <div class="hero__in">
    <p class="eyebrow">For Contractors</p>
    <h1 class="h1">Go Live in 14–21 Days with a Contractor Site + Instant Quote That Books Jobs</h1>
    <p class="sub">Founder Program: we’re taking <b>3 contractors</b> at <b>$3,000</b> to install a premium site, a simple Instant Quote flow, and three ready‑to‑run campaigns. You own everything—no retainer.</p>
    <ul class="chips" aria-label="Highlights">
      <li>Premium 8‑section site</li>
      <li>Instant Quote & text‑back follow‑up</li>
      <li>3 focused landing pages</li>
      <li>Tracking + CRM hookup</li>
    </ul>
    <div class="cta">
      <a href="#apply" class="btn btn--primary">Apply & Hold Your Slot (72 hrs)</a>
      <a href="#process" class="btn btn--ghost">See How It Works</a>
    </div>
  </div>
</header>


<!-- PROCESS -->
<section id="process" class="section" aria-label="Immersive How It Works">
  <div class="shell">
    <div class="card flow">
      <div class="card-head">
        <h2 class="card-title">How It Works — Your Build in Motion</h2>
        <span class="pill" id="flowPct" aria-live="polite">0%</span>
      </div>
      <div class="card-body">
        <div class="flow-rail" aria-hidden="true"><div class="flow-bar" id="flowBar"></div></div>
        <div class="flow-steps" id="flowSteps" role="list">
          <div class="flow-step" role="listitem" data-step="1">
            <div class="flow-ico" aria-hidden="true">
              <!-- calendar svg -->
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7 2v3M17 2v3M3 9h18M5 5h14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2Z" stroke="#9fd6ff" stroke-width="1.6" stroke-linecap="round"/></svg>
            </div>
            <p class="flow-ttl">Kickoff</p>
            <p class="flow-hint">Pick your priority service & city. Map your offer and quote flow.</p>
          </div>
          <div class="flow-step" role="listitem" data-step="2">
            <div class="flow-ico" aria-hidden="true">
              <!-- layout svg -->
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="4" width="18" height="6" rx="1.6" stroke="#9fd6ff" stroke-width="1.6"/><rect x="3" y="12" width="8.8" height="8" rx="1.6" stroke="#9fd6ff" stroke-width="1.6"/><rect x="13.2" y="12" width="7.8" height="8" rx="1.6" stroke="#9fd6ff" stroke-width="1.6"/></svg>
            </div>
            <p class="flow-ttl">Build</p>
            <p class="flow-hint">8‑section site + 3 landing pages with Instant Quote installed.</p>
          </div>
          <div class="flow-step" role="listitem" data-step="3">
            <div class="flow-ico" aria-hidden="true">
              <!-- bolt svg -->
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13 2 4 14h6l-1 8 9-12h-6l1-8Z" stroke="#9fd6ff" stroke-width="1.6" stroke-linejoin="round"/></svg>
            </div>
            <p class="flow-ttl">Launch</p>
            <p class="flow-hint">Tracking wired, CRM/text connected, campaigns loaded.</p>
          </div>
          <div class="flow-step" role="listitem" data-step="4">
            <div class="flow-ico" aria-hidden="true">
              <!-- chat svg -->
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20 15.5c1.1-1 1.8-2.4 1.8-3.9C21.8 8.6 19.1 6 15.8 6H8.2C4.9 6 2.2 8.6 2.2 11.6c0 3 2.7 5.6 6 5.6h.7v3.1l3.9-3.1h3c1.3 0 2.6-.5 3.6-1.2Z" stroke="#9fd6ff" stroke-width="1.6" stroke-linejoin="round"/></svg>
            </div>
            <p class="flow-ttl">Follow‑ups</p>
            <p class="flow-hint">Auto text/email in seconds. No cold leads left behind.</p>
          </div>
        </div>
        <div class="flow-done" id="flowDone" aria-live="polite" hidden>
          <p class="hint" style="margin:0">✅ <b>Done‑for‑you sales system installed.</b> Site + Instant Quote + tracking + campaigns, ready to book jobs.</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- QUIZ (MAIN CTA) -->
<section id="quiz" class="panel panel--img quizpanel" style="--panel-img:url('YOUR-SECTION-IMAGE.jpg')" aria-label="Quick Builder Quiz">
  <div class="qp-wrap qp">
    <p class="eyebrow">Quick Builder Quiz</p>
    <h2 class="h1" style="font-size:clamp(28px,5vw,48px);margin-bottom:.4rem">Let’s see if we’re a fit</h2>
    <p class="qp-intro">Answer a few questions (~60 seconds). You’ll hold a Founder slot for 72 hours while we review.</p>

    <div class="qp-card" role="form">
      <div class="qp-head">
        <h3 class="qp-title">Application — Contractors Founder Program ($3,000)</h3>
        <span class="qp-pill">Step <b id="qpStepNum">1</b> / 3</span>
      </div>

      <div class="qp-rail" aria-hidden="true"><i id="qpBar"></i></div>

      <form id="qpForm" class="qp-grid" autocomplete="on" novalidate>
        <!-- STEP 1 -->
        <div class="qp-step" data-step="1">
          <div class="qp-grid two">
            <div><label class="label" for="first_name">First name</label><input id="first_name" class="input" name="first_name" required></div>
            <div><label class="label" for="city">City/Area</label><input id="city" class="input" name="city" required></div>
          </div>
          <div class="qp-grid two">
            <div><label class="label" for="service">Primary service</label>
              <select id="service" class="input" name="service" required>
                <option value="">Select…</option>
                <option>Remodel</option><option>Roofing</option><option>HVAC</option>
                <option>General Contractor</option><option>Landscaping</option>
              </select>
            </div>
            <div><label class="label" for="company">Company (optional)</label><input id="company" class="input" name="company" placeholder="Optional"></div>
          </div>
        </div>

        <!-- STEP 2 -->
        <div class="qp-step" data-step="2" hidden>
          <div>
            <label class="label" for="why_us">Why should we work with you?</label>
            <textarea id="why_us" name="why_us" placeholder="What makes you different: reputation, team, guarantees…" required></textarea>
          </div>
          <div>
            <label class="label" for="goal">What’s your primary goal with us?</label>
            <textarea id="goal" name="goal" placeholder="Book more estimates, seasonal promo, improve close rate, cut response time…" required></textarea>
          </div>
        </div>

        <!-- STEP 3 -->
        <div class="qp-step" data-step="3" hidden>
          <div class="qp-grid two">
            <div>
              <label class="label" for="budget">Budget range</label>
              <select id="budget" class="input" name="budget" required>
                <option value="">Select…</option>
                <option>$1k–$2k</option><option>$3k–$5k</option>
                <option>$6k–$10k</option><option>$10k+</option>
              </select>
            </div>
            <div>
              <label class="label" for="timeline">Timeline</label>
              <select id="timeline" class="input" name="timeline" required>
                <option value="">Select…</option>
                <option>ASAP (this month)</option><option>30–45 days</option><option>60–90 days</option>
              </select>
            </div>
          </div>
          <div class="qp-grid two">
            <div><label class="label" for="email">Email</label><input id="email" class="input" type="email" name="email" required></div>
            <div><label class="label" for="phone">Phone</label><input id="phone" class="input" type="tel" name="phone" placeholder="Optional"></div>
          </div>
          <p class="hint" style="margin:.4rem 0 0">We’ll only contact you about this project. Opt out anytime.</p>
        </div>

        <p class="qp-err" id="qpErr">Please complete the required fields.</p>
        <div class="qp-ok" id="qpOk"><p>Thanks! We received your quiz. Your 72‑hour hold is active.</p></div>

        <div class="qp-actions">
          <button type="button" class="btn btn--ghost" id="qpPrev">Back</button>
          <div style="display:flex; gap:10px">
            <button type="button" class="btn btn--ghost" id="qpSave">Save</button>
            <button type="button" class="btn btn--primary" id="qpNext">Next</button>
            <button type="submit" class="btn btn--primary" id="qpSubmit" style="display:none">Submit</button>
          </div>
        </div>
      </form>
    </div>
  </div>
</section>

<!-- OFFER / VALUE -->
<section id="offer" class="panel" aria-label="Founder Offer">
  <div class="shell" style="text-align:center">
    <p class="eyebrow">Founder Program</p>
    <h2 class="h1" style="font-size:clamp(28px,5vw,48px);margin-bottom:.2rem">Everything you need to book jobs — for $3,000</h2>
    <p class="sub" style="margin:0 auto 1.4rem;max-width:70ch">Agencies charge <b>$6,000–$8,000</b> for a website alone. You’re getting a full custom site, <b>3 landing pages</b>, <b>automations</b>, an <b>Instant Quote</b> tool, and <b>4 money‑model campaigns</b> — a system we value at <b>$7,500+</b>.</p>
    <ul class="chips" style="justify-content:center">
      <li>$6–8k — Custom contractor website</li>
      <li>$2.5k+ — Automation & CRM</li>
      <li>$2k+ — Campaign playbooks</li>
      <li>$1.5k+ — Instant Quote tool</li>
    </ul>
    <p class="sub" style="margin:.6rem 0 1.2rem">Founder price: <b>$3,000</b> — <b>3 slots</b> only</p>
    <div class="cta" style="justify-content:center">
      <a class="btn btn--primary" href="#apply">Apply for a Founder Slot</a>
      <a class="btn btn--ghost" href="#process">See How It Works</a>
    </div>
  </div>
</section>

<!-- WHO WE TAKE (Qualification) -->
<section class="section" aria-label="Qualification">
  <div class="shell">
    <div class="card">
      <div class="card-head"><h2 class="card-title">Who We’re a Fit For</h2></div>
      <div class="card-body" style="display:grid;gap:12px;grid-template-columns:1fr 1fr">
        <div class="sec"><p class="sec-title">Yes</p><p class="hint">Local contractors with a clear service and capacity to handle new estimates this month.</p></div>
        <div class="sec"><p class="sec-title">Not Yet</p><p class="hint">If branding isn’t ready or you can’t respond to leads within hours, we’ll pause your slot.</p></div>
      </div>
    </div>
  </div>
</section>

<!-- APPLY (Anchor target) -->
<section id="apply" class="panel" aria-label="Apply">
  <div class="shell" style="text-align:center">
    <p class="eyebrow">Apply now</p>
    <h2 class="h1" style="font-size:clamp(28px,5vw,48px);margin-bottom:.2rem">Hold your Founder slot for 72 hours</h2>
    <p class="sub" style="max-width:70ch;margin:0 auto 1rem">Tell us your primary service and city. We’ll confirm fit and send a fast plan.</p>
    <div class="cta" style="justify-content:center;margin-bottom:1rem">
      <a href="#quiz" class="btn btn--primary">Start the 60‑second Quiz</a>
      <a href="#process" class="btn btn--ghost">See How It Works</a>
    </div>
    <!-- Optional: Calendly embed (uncomment to enable) -->
    <!--
    <div style="border:1px solid #1e232e;border-radius:12px;overflow:hidden">
      <iframe src="https://calendly.com/YOUR-LINK/intro?hide_event_type_details=1&hide_gdpr_banner=1" style="width:100%;height:720px;border:0" title="Book a quick intro"></iframe>
    </div>
    -->
  </div>
</section>

<!-- STICKY CTA -->
<div class="stickybar" role="region" aria-label="Sticky CTA">
  <div class="shell stickybar__in">
    <div style="font-weight:800;color:#E8EEF6;">Founder Build $3,000 · <span style="color:#9fd6ff">3 slots</span> · 72‑hour hold when you apply</div>
    <div style="display:flex;gap:8px;flex-wrap:wrap">
      <a class="btn btn--primary" href="#apply">Apply Now</a>
      <a class="btn btn--ghost" href="#process">See How It Works</a>
    </div>
  </div>
</div>

<!-- FOOTER -->
<footer class="footer">
  <div class="shell">© <span id="year"></span> BIM Labs. All rights reserved.</div>
</footer>

<script>
// Footer year
document.getElementById('year').textContent = new Date().getFullYear();

// Quiz logic (single source of truth)
(function(){
  const $ = s => document.querySelector(s);
  const $$= s => [...document.querySelectorAll(s)];
  const form = $('#qpForm'); if(!form) return;

  const steps   = $$('.qp-step');
  const bar     = $('#qpBar');
  const stepNum = $('#qpStepNum');
  const err     = $('#qpErr');
  const ok      = $('#qpOk');
  const prev    = $('#qpPrev');
  const next    = $('#qpNext');
  const save    = $('#qpSave');
  const submit  = $('#qpSubmit');

  let step = 1; const max = steps.length; const KEY='bim_qp_v1';

  function show(n){
    step = Math.max(1, Math.min(max, n));
    steps.forEach(s => s.hidden = (+s.dataset.step !== step));
    stepNum.textContent = String(step);
    bar.style.width = (step/max*100) + '%';
    prev.style.visibility = step===1 ? 'hidden' : 'visible';
    next.style.display    = step===max ? 'none'   : 'inline-flex';
    submit.style.display  = step===max ? 'inline-flex' : 'none';
    err.style.display = 'none';
  }
  function validCurrent(){
    const req = steps[step-1].querySelectorAll('[required]');
    for (const f of req){ if(!f.value.trim()){ err.style.display='block'; f.focus(); return false; } }
    return true;
  }

  next.addEventListener('click', ()=> { if(validCurrent()) show(step+1); });
  prev.addEventListener('click', ()=> show(step-1));

  save.addEventListener('click', ()=>{
    const data = Object.fromEntries(new FormData(form).entries());
    localStorage.setItem(KEY, JSON.stringify(data));
    save.textContent='Saved'; setTimeout(()=> save.textContent='Save', 1000);
  });

  // Restore saved
  try{
    const saved = JSON.parse(localStorage.getItem(KEY)||'{}');
    for(const [k,v] of Object.entries(saved)){ const el=form.elements[k]; if(el) el.value=v; }
  }catch{}

  // Capture UTMs / attribution
  const params = new URLSearchParams(location.search);
  const utm = ['utm_source','utm_medium','utm_campaign','utm_term','utm_content']
    .reduce((o,k)=>{ const v = params.get(k) || localStorage.getItem(k) || ''; if(v) localStorage.setItem(k,v); o[k]=v; return o; }, {});

  form.addEventListener('submit', async (e)=>{
    e.preventDefault(); err.style.display='none'; ok.style.display='none';
    // Validate all steps
    for(const s of steps){
      const req = s.querySelectorAll('[required]');
      for(const f of req){ if(!f.value.trim()){ err.style.display='block'; f.focus(); return; } }
    }
    const payload = {
      source:'BIM Founders — Contractor Quiz (Panel)',
      ...Object.fromEntries(new FormData(form).entries()),
      ...utm,
      landing_path: location.pathname + location.search,
      referrer: document.referrer || '',
      hold_expires_at: new Date(Date.now()+72*3600*1000).toISOString()
    };
    try{
      await fetch('https://formspree.io/f/xkgbgbjd',{
        method:'POST', headers:{'Accept':'application/json','Content-Type':'application/json'},
        body: JSON.stringify(payload)
      });
      ok.style.display='block';
      localStorage.removeItem(KEY);
      form.reset(); show(1);
    }catch{
      err.textContent='Could not submit right now. Please try again in a moment.';
      err.style.display='block';
    }
  });

  // Keyboard: Enter advances when appropriate
  form.addEventListener('keydown', (e)=>{
    if(e.key==='Enter' && e.target.tagName!=='TEXTAREA'){
      e.preventDefault();
      if(step<max){ if(validCurrent()) show(step+1); } else { submit.click(); }
    }
  });

  show(1);
})();
</script>

<!-- Optional: GA4 / Meta Pixel placeholders -->
<!-- <script>/* GA4 gtag here; fire conversion on qpSubmit */</script> -->

<script>
// Immersive flow animation on view
(function(){
  const wrap = document.getElementById('flowSteps');
  if(!wrap) return;
  const steps = [...wrap.querySelectorAll('.flow-step')];
  const bar   = document.getElementById('flowBar');
  const pctEl = document.getElementById('flowPct');
  const done  = document.getElementById('flowDone');
  let ran=false;
  function run(){
    if(ran) return; ran=true;
    let i=0;
    function tick(){
      if(i<steps.length){
        steps[i].classList.add('is-on');
        const pct = Math.round(((i+1)/steps.length)*100);
        bar.style.width = pct + '%';
        if(pctEl) pctEl.textContent = pct + '%';
        i++; setTimeout(tick, 650);
      }else{
        if(done){ done.hidden=false; }
      }
    }
    tick();
  }
  const io = new IntersectionObserver((entries)=>{
    entries.forEach(e=>{ if(e.isIntersecting) run(); });
  }, {threshold: .35});
  io.observe(document.getElementById('process'));
})();
</script>
</body>
</html>
